version: "3.9"

services:
  aas-env:
    image: eclipsebasyx/aas-environment:2.0.0-SNAPSHOT
    container_name: aas-env
    environment:
      # interner Serverport der AAS Environment
      - SERVER_PORT=8081
      # CORS: Browser-Frontend (Port 3000) darf auf Port 8081 zugreifen
      - BASYX_CORS_ALLOWED_ORIGINS=http://localhost:3000
      - BASYX_CORS_ALLOWED_METHODS=GET,POST,PATCH,DELETE,PUT,OPTIONS,HEAD
    ports:
      # HostPort:ContainerPort  → 8081 von außen erreichbar
      - "8081:8081"
    restart: unless-stopped

  aas-web-ui:
    image: eclipsebasyx/aas-gui
    container_name: aas-web-ui
    ports:
      # WICHTIG: Die GUI hört in der Doku auf Port 3000, nicht 80
      - "3000:3000"
    environment:
      # Diese URLs werden im Browser aufgerufen, daher MUSS hier "localhost" stehen
      AAS_REPO_PATH: "http://localhost:8081/shells"
      SUBMODEL_REPO_PATH: "http://localhost:8081/submodels"
      CD_REPO_PATH: "http://localhost:8081/concept-descriptions"
    depends_on:
      - aas-env
    restart: unless-stopped
